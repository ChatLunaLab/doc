# 长期记忆

长期记忆是 ChatLuna 一直在迭代和探索的一项功能。

经过了多次迭代，目前终于迎来了相对稳定和成熟的版本。

目前长期记忆具有以下特性：

- 基于模型和用户的对话历史，提取关键信息，并存储到向量数据库中。
- 多层级的长期记忆，包括：预设层、全局层、群组层、用户层。并支持联合检索
- 支持多种长期记忆引擎，可以为每个层级设置不同的长期记忆引擎。
- 模拟人类的记忆分类，并添加记忆遗忘实现。
- 即使清除房间内的聊天记录，长期记忆依然存在。

## 配置

请参考 [长期记忆插件](../../ecosystem/plugin/long-term-memory.md) 进行配置。

## 命令

ChatLuna 提供了一组命令来管理长期记忆。

以下为命令列表：

- [添加长期记忆](../useful-commands/memory.md#添加长期记忆)
- [删除长期记忆](../useful-commands/memory.md#删除长期记忆)
- [修改长期记忆](../useful-commands/memory.md#修改长期记忆)
- [清除（所有的）长期记忆](../useful-commands/memory.md#清除长期记忆)

## 测试

即使你已经配置好了长期记忆，也需要通过测试来确保其正常工作。

我们可以设置 [长期记忆存储轮次](../useful-configurations.md#longmemoryinterval) 为 1，这样每条消息都会被存储到向量数据库中。

开启 [`isLog`](../useful-configurations.md#islog) 选项，这样则会打印出更多的日志信息。

完成后尝试和模型对话，发送多条消息。

稍等片刻，在 Koishi 日志中将会看到提取关键信息并存储到向量数据库中的日志。

![alt text](../../public/images/image-27.png)

清除房间内的聊天记录，再次发送消息，确保之前存储的记忆依然存在。

![alt](../../public/images/image-28.png)

这时候就可以正常使用长期记忆功能了。

## 已知问题

- 提取出来的文本内容可能会干扰模型的正常回复。
